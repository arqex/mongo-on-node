"use strict";define(["jquery","underscore","backbone"],function(d,i,h){var e={test:["message"]};var g=h.Model.extend({idAttribute:"_id"});var c=h.Collection.extend({model:g,initialize:function(k,j){this.type=j.type;
this.url="/api/docs/"+this.type;}});var a=g.extend({idAttribute:"name",initialize:function(j,k){this.type=k.type;this.set("name",k.type);this.settingsFetched=false;
},query:function(k){var l=new c([],{type:this.get("name")}),j=d.Deferred();l.fetch({data:k,success:function(){j.resolve(l,k);}});return j.promise();},getSettings:function(){var k=this,j=d.Deferred();
if(this.settingsFetched){j.resolve(this.toJSON());}else{this.fetch({success:function(){k.settingsFetched=true;j.resolve(k.toJSON());}});}return j.promise();
},url:function(){return"/api/settings/collection_"+this.type;}});var b=h.Collection.extend({model:a,url:"/api/collections",fetch:function(k){var l=this,j=d.Deferred();
d.get(this.url,{},function(m){i.each(m,function(n){l.add(new l.model({},{type:n}));});j.resolve();},"json");return j.promise();},findByType:function(j){return this.find(function(k){return k.type==j;
});}});var f=function(){var j={},l=function(o){var n=new g();n.urlRoot="/api/docs/"+o;n.type=o;n.fields=e[o];return n;},m=function(n){if(j.type){return j.type;
}var o=new a([],{type:n});return o;},k=function(){return new b();};return{getMDoc:l,getMCollection:m,getMCollectionList:k};};return f();});